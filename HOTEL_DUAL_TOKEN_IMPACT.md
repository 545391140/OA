# åŒ Token å¯¹åŸæœ‰ä¸šåŠ¡çš„å½±å“åˆ†æ

## ğŸ“‹ æ ¸å¿ƒç»“è®º

**âœ… ä¸ä¼šå¯¹åŸæœ‰ä¸šåŠ¡äº§ç”Ÿå½±å“**

åŒ Token æ˜¯**ç‹¬ç«‹çš„ç¼“å­˜æœºåˆ¶**ï¼Œäº’ä¸å¹²æ‰°ï¼Œä¸ä¼šå½±å“èˆªç­ä¸šåŠ¡æˆ–å…¶ä»–ä¸šåŠ¡ã€‚

---

## ğŸ” å½“å‰ Token ä½¿ç”¨æƒ…å†µ

### 1. ç°æœ‰ Token ç®¡ç†ï¼ˆbase.jsï¼‰

```javascript
// backend/services/amadeus/base.js
// Token ç¼“å­˜ï¼ˆæ¨¡å—çº§å˜é‡ï¼‰
let tokenCache = {
  accessToken: null,
  expiresAt: null,
};

async function getAccessToken() {
  // æ£€æŸ¥ç¼“å­˜æ˜¯å¦æœ‰æ•ˆï¼ˆæå‰5åˆ†é’Ÿåˆ·æ–°ï¼‰
  if (tokenCache.accessToken && tokenCache.expiresAt && 
      Date.now() < tokenCache.expiresAt - 5 * 60 * 1000) {
    return tokenCache.accessToken;  // è¿”å›ç¼“å­˜çš„ Token
  }
  
  // è·å–æ–° Token
  const response = await axios.post(`${baseURL}/v1/security/oauth2/token`, {...});
  tokenCache = {
    accessToken: response.data.access_token,
    expiresAt: Date.now() + expiresIn * 1000,
  };
  return tokenCache.accessToken;
}
```

**ä½¿ç”¨èŒƒå›´**ï¼š
- âœ… `flightSearch.js` - èˆªç­æœç´¢
- âœ… `booking.js` - èˆªç­é¢„è®¢
- âœ… æ‰€æœ‰èˆªç­ç›¸å…³çš„ API è°ƒç”¨

**ç‰¹ç‚¹**ï¼š
- æ¨¡å—çº§ç¼“å­˜ï¼ˆå•ä¾‹æ¨¡å¼ï¼‰
- æ‰€æœ‰èˆªç­ä¸šåŠ¡å…±äº«åŒä¸€ä¸ª Token
- Token æœ‰æ•ˆæœŸï¼š1799ç§’ï¼ˆçº¦30åˆ†é’Ÿï¼‰
- æå‰5åˆ†é’Ÿåˆ·æ–°

---

### 2. SDK Token ç®¡ç†ï¼ˆå¦‚æœä½¿ç”¨ï¼‰

```javascript
// SDK å†…éƒ¨å®ç°ï¼ˆç®€åŒ–ç‰ˆï¼‰
class Amadeus {
  constructor(config) {
    this.config = config;
    this.tokenCache = {  // SDK å†…éƒ¨çš„ Token ç¼“å­˜
      accessToken: null,
      expiresAt: null,
    };
  }
  
  async getAccessToken() {
    // SDK å†…éƒ¨æ£€æŸ¥ç¼“å­˜
    if (this.tokenCache.accessToken && 
        Date.now() < this.tokenCache.expiresAt - 5 * 60 * 1000) {
      return this.tokenCache.accessToken;
    }
    
    // SDK å†…éƒ¨è·å–æ–° Token
    const response = await this.requestToken();
    this.tokenCache = {
      accessToken: response.access_token,
      expiresAt: Date.now() + response.expires_in * 1000,
    };
    return this.tokenCache.accessToken;
  }
}
```

**ä½¿ç”¨èŒƒå›´**ï¼š
- âœ… `hotelSearchSdk.js` - é…’åº—æœç´¢ï¼ˆå¦‚æœä½¿ç”¨ SDKï¼‰
- âœ… æ‰€æœ‰é…’åº—ç›¸å…³çš„ API è°ƒç”¨

**ç‰¹ç‚¹**ï¼š
- SDK å†…éƒ¨ç¼“å­˜ï¼ˆç‹¬ç«‹å®ä¾‹ï¼‰
- æ‰€æœ‰é…’åº—ä¸šåŠ¡å…±äº« SDK çš„ Token
- Token æœ‰æ•ˆæœŸï¼š1799ç§’ï¼ˆçº¦30åˆ†é’Ÿï¼‰
- æå‰5åˆ†é’Ÿåˆ·æ–°

---

## ğŸ”„ åŒ Token è¿è¡Œæœºåˆ¶

### Token è·å–æµç¨‹å¯¹æ¯”

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  èˆªç­ä¸šåŠ¡ï¼ˆbase.js Tokenï¼‰              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  1. flightSearch.js è°ƒç”¨                â”‚
â”‚  2. getAccessToken() æ£€æŸ¥ç¼“å­˜          â”‚
â”‚  3. å¦‚æœæœ‰æ•ˆ â†’ è¿”å›ç¼“å­˜ Token           â”‚
â”‚  4. å¦‚æœæ— æ•ˆ â†’ è·å–æ–° Token â†’ ç¼“å­˜     â”‚
â”‚  5. è¿”å› Token ç»™ flightSearch.js       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  é…’åº—ä¸šåŠ¡ï¼ˆSDK Tokenï¼‰                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  1. hotelSearchSdk.js è°ƒç”¨              â”‚
â”‚  2. SDK å†…éƒ¨æ£€æŸ¥ç¼“å­˜                    â”‚
â”‚  3. å¦‚æœæœ‰æ•ˆ â†’ è¿”å›ç¼“å­˜ Token           â”‚
â”‚  4. å¦‚æœæ— æ•ˆ â†’ è·å–æ–° Token â†’ ç¼“å­˜     â”‚
â”‚  5. è¿”å› Token ç»™ hotelSearchSdk.js     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**å…³é”®ç‚¹**ï¼š
- âœ… **ä¸¤ä¸ª Token ç¼“å­˜å®Œå…¨ç‹¬ç«‹**
- âœ… **äº’ä¸å¹²æ‰°ï¼Œäº’ä¸å½±å“**
- âœ… **å„è‡ªç®¡ç†è‡ªå·±çš„ç”Ÿå‘½å‘¨æœŸ**

---

## âœ… ä¸ä¼šå½±å“åŸæœ‰ä¸šåŠ¡çš„åŸå› 

### 1. **Token ç¼“å­˜éš”ç¦»** âœ…

#### å†…å­˜éš”ç¦»
```javascript
// base.js çš„ Token ç¼“å­˜ï¼ˆæ¨¡å—çº§ï¼‰
let tokenCache = {
  accessToken: 'token_from_base_js',
  expiresAt: Date.now() + 1799 * 1000,
};

// SDK çš„ Token ç¼“å­˜ï¼ˆSDK å®ä¾‹å†…éƒ¨ï¼‰
const amadeus = new Amadeus({...});
// SDK å†…éƒ¨ï¼š
// this.tokenCache = {
//   accessToken: 'token_from_sdk',
//   expiresAt: Date.now() + 1799 * 1000,
// };
```

**éªŒè¯**ï¼š
- âœ… ä¸¤ä¸ª Token å­˜å‚¨åœ¨ä¸åŒçš„å†…å­˜ä½ç½®
- âœ… äº’ä¸è¦†ç›–ï¼Œäº’ä¸å½±å“
- âœ… å„è‡ªç‹¬ç«‹ç®¡ç†

#### ä½œç”¨åŸŸéš”ç¦»
```javascript
// base.js - æ¨¡å—ä½œç”¨åŸŸ
let tokenCache = {...};  // åªåœ¨ base.js æ¨¡å—å†…å¯è§

// SDK - å®ä¾‹ä½œç”¨åŸŸ
class Amadeus {
  constructor() {
    this.tokenCache = {...};  // åªåœ¨ SDK å®ä¾‹å†…å¯è§
  }
}
```

**éªŒè¯**ï¼š
- âœ… ä½œç”¨åŸŸå®Œå…¨éš”ç¦»
- âœ… ä¸ä¼šäº’ç›¸è®¿é—®
- âœ… ä¸ä¼šäº’ç›¸ä¿®æ”¹

---

### 2. **API è°ƒç”¨éš”ç¦»** âœ…

#### èˆªç­ä¸šåŠ¡è°ƒç”¨é“¾
```javascript
// èˆªç­æœç´¢
flightSearch.js
  â†’ base.js.getAccessToken()  // ä½¿ç”¨ base.js çš„ Token
  â†’ axios.get('/v2/shopping/flight-offers', {
      headers: {
        'Authorization': `Bearer ${token_from_base_js}`
      }
    })
```

#### é…’åº—ä¸šåŠ¡è°ƒç”¨é“¾
```javascript
// é…’åº—æœç´¢ï¼ˆä½¿ç”¨ SDKï¼‰
hotelSearchSdk.js
  â†’ amadeus.shopping.hotelOffersSearch.get({...})
    â†’ SDK å†…éƒ¨ getAccessToken()  // ä½¿ç”¨ SDK çš„ Token
    â†’ SDK å†…éƒ¨ axios.get('/v3/shopping/hotel-offers', {
        headers: {
          'Authorization': `Bearer ${token_from_sdk}`
        }
      })
```

**éªŒè¯**ï¼š
- âœ… èˆªç­ä¸šåŠ¡åªä½¿ç”¨ base.js çš„ Token
- âœ… é…’åº—ä¸šåŠ¡åªä½¿ç”¨ SDK çš„ Token
- âœ… è°ƒç”¨é“¾å®Œå…¨éš”ç¦»

---

### 3. **Token æœ‰æ•ˆæ€§ç‹¬ç«‹** âœ…

#### Token ç”Ÿå‘½å‘¨æœŸå¯¹æ¯”

| æ—¶é—´ç‚¹ | base.js Token | SDK Token | å½±å“ |
|--------|--------------|----------|------|
| T=0 | è·å– Token A | - | èˆªç­å¯ç”¨ |
| T=5min | Token A æœ‰æ•ˆ | è·å– Token B | èˆªç­å¯ç”¨ï¼Œé…’åº—å¯ç”¨ |
| T=25min | Token A æœ‰æ•ˆ | Token B æœ‰æ•ˆ | èˆªç­å¯ç”¨ï¼Œé…’åº—å¯ç”¨ |
| T=26min | Token A è¿‡æœŸï¼Œåˆ·æ–°ä¸º Token C | Token B æœ‰æ•ˆ | èˆªç­å¯ç”¨ï¼ˆæ–°Tokenï¼‰ï¼Œé…’åº—å¯ç”¨ |
| T=30min | Token C æœ‰æ•ˆ | Token B è¿‡æœŸï¼Œåˆ·æ–°ä¸º Token D | èˆªç­å¯ç”¨ï¼Œé…’åº—å¯ç”¨ï¼ˆæ–°Tokenï¼‰ |

**éªŒè¯**ï¼š
- âœ… ä¸¤ä¸ª Token çš„ç”Ÿå‘½å‘¨æœŸå®Œå…¨ç‹¬ç«‹
- âœ… Token A è¿‡æœŸä¸å½±å“ Token B
- âœ… Token B è¿‡æœŸä¸å½±å“ Token A
- âœ… å„è‡ªç‹¬ç«‹åˆ·æ–°ï¼Œäº’ä¸å¹²æ‰°

---

### 4. **API è°ƒç”¨é¢‘ç‡** âœ…

#### Token è·å–é¢‘ç‡åˆ†æ

**åœºæ™¯ 1ï¼šåªæœ‰èˆªç­ä¸šåŠ¡**
```
æ—¶é—´çº¿ï¼š
T=0:    è·å– Tokenï¼ˆbase.jsï¼‰
T=5min: ä½¿ç”¨ Tokenï¼ˆbase.js ç¼“å­˜ï¼‰
T=25min: ä½¿ç”¨ Tokenï¼ˆbase.js ç¼“å­˜ï¼‰
T=26min: åˆ·æ–° Tokenï¼ˆbase.jsï¼‰
```

**åœºæ™¯ 2ï¼šèˆªç­ + é…’åº—ä¸šåŠ¡ï¼ˆåŒ Tokenï¼‰**
```
æ—¶é—´çº¿ï¼š
T=0:    è·å– Token Aï¼ˆbase.jsï¼‰
T=1min: è·å– Token Bï¼ˆSDKï¼‰
T=5min: ä½¿ç”¨ Token Aï¼ˆbase.js ç¼“å­˜ï¼‰
T=6min: ä½¿ç”¨ Token Bï¼ˆSDK ç¼“å­˜ï¼‰
T=25min: ä½¿ç”¨ Token Aï¼ˆbase.js ç¼“å­˜ï¼‰
T=26min: ä½¿ç”¨ Token Bï¼ˆSDK ç¼“å­˜ï¼‰
T=26min: åˆ·æ–° Token Aï¼ˆbase.jsï¼‰
T=31min: åˆ·æ–° Token Bï¼ˆSDKï¼‰
```

**å½±å“åˆ†æ**ï¼š
- âœ… **Token è·å–é¢‘ç‡**ï¼šä» 1 æ¬¡/30åˆ†é’Ÿ â†’ 2 æ¬¡/30åˆ†é’Ÿ
- âœ… **API è°ƒç”¨é¢‘ç‡**ï¼šå¢åŠ  1 æ¬¡/30åˆ†é’Ÿï¼ˆå¯å¿½ç•¥ï¼‰
- âœ… **Amadeus API é™åˆ¶**ï¼šé€šå¸¸å…è®¸ 10 requests/secondï¼Œå®Œå…¨è¶³å¤Ÿ

**ç»“è®º**ï¼š
- âœ… Token è·å–é¢‘ç‡å¢åŠ å¾ˆå°ï¼ˆ1æ¬¡/30åˆ†é’Ÿï¼‰
- âœ… ä¸ä¼šè§¦å‘ API é¢‘ç‡é™åˆ¶
- âœ… å¯¹æ€§èƒ½å½±å“å¯å¿½ç•¥

---

### 5. **é”™è¯¯å¤„ç†éš”ç¦»** âœ…

#### Token è·å–å¤±è´¥åœºæ™¯

**åœºæ™¯ 1ï¼šbase.js Token è·å–å¤±è´¥**
```javascript
// åªå½±å“èˆªç­ä¸šåŠ¡
flightSearch.js
  â†’ base.js.getAccessToken()  // å¤±è´¥
  â†’ æŠ›å‡ºé”™è¯¯
  â†’ èˆªç­æœç´¢å¤±è´¥
  â†’ é…’åº—ä¸šåŠ¡ä¸å—å½±å“ï¼ˆä½¿ç”¨ SDK Tokenï¼‰
```

**åœºæ™¯ 2ï¼šSDK Token è·å–å¤±è´¥**
```javascript
// åªå½±å“é…’åº—ä¸šåŠ¡
hotelSearchSdk.js
  â†’ SDK.getAccessToken()  // å¤±è´¥
  â†’ æŠ›å‡ºé”™è¯¯
  â†’ é…’åº—æœç´¢å¤±è´¥
  â†’ èˆªç­ä¸šåŠ¡ä¸å—å½±å“ï¼ˆä½¿ç”¨ base.js Tokenï¼‰
```

**éªŒè¯**ï¼š
- âœ… Token è·å–å¤±è´¥åªå½±å“å¯¹åº”çš„ä¸šåŠ¡
- âœ… ä¸ä¼šäº’ç›¸å½±å“
- âœ… é”™è¯¯éš”ç¦»

---

## ğŸ“Š å½±å“è¯„ä¼°è¡¨

| å½±å“é¡¹ | å½±å“ç¨‹åº¦ | è¯´æ˜ | ç»“è®º |
|--------|---------|------|------|
| **Token ç¼“å­˜å†²çª** | âœ… æ— å½±å“ | ä¸¤ä¸ªç¼“å­˜å®Œå…¨éš”ç¦» | âœ… å®‰å…¨ |
| **API è°ƒç”¨å†²çª** | âœ… æ— å½±å“ | è°ƒç”¨é“¾å®Œå…¨éš”ç¦» | âœ… å®‰å…¨ |
| **Token æœ‰æ•ˆæ€§** | âœ… æ— å½±å“ | ç”Ÿå‘½å‘¨æœŸç‹¬ç«‹ | âœ… å®‰å…¨ |
| **API è°ƒç”¨é¢‘ç‡** | âš ï¸ è½»å¾®å¢åŠ  | å¢åŠ  1 æ¬¡/30åˆ†é’Ÿ | âœ… å¯æ¥å— |
| **é”™è¯¯ä¼ æ’­** | âœ… æ— å½±å“ | é”™è¯¯éš”ç¦» | âœ… å®‰å…¨ |
| **æ€§èƒ½å½±å“** | âœ… æ— å½±å“ | å¯å¿½ç•¥ | âœ… å®‰å…¨ |
| **èˆªç­ä¸šåŠ¡** | âœ… æ— å½±å“ | å®Œå…¨ä¸å—å½±å“ | âœ… å®‰å…¨ |
| **é…’åº—ä¸šåŠ¡** | âœ… æ— å½±å“ | å®Œå…¨ä¸å—å½±å“ | âœ… å®‰å…¨ |

---

## ğŸ” å®é™…è¿è¡Œåœºæ™¯åˆ†æ

### åœºæ™¯ 1ï¼šç”¨æˆ·åŒæ—¶æœç´¢èˆªç­å’Œé…’åº—

```javascript
// ç”¨æˆ·æ“ä½œï¼šåŒæ—¶æœç´¢èˆªç­å’Œé…’åº—

// 1. æœç´¢èˆªç­
flightController.searchFlights()
  â†’ flightSearch.searchFlightOffers()
    â†’ base.js.getAccessToken()  // è·å–/ä½¿ç”¨ base.js Token
    â†’ axios.get('/v2/shopping/flight-offers')
    âœ… æˆåŠŸè¿”å›èˆªç­ç»“æœ

// 2. æœç´¢é…’åº—ï¼ˆåŒæ—¶è¿›è¡Œï¼‰
hotelController.searchHotels()
  â†’ hotelSearchSdk.searchHotelOffers()
    â†’ SDK.getAccessToken()  // è·å–/ä½¿ç”¨ SDK Token
    â†’ SDK å†…éƒ¨è°ƒç”¨ API
    âœ… æˆåŠŸè¿”å›é…’åº—ç»“æœ
```

**ç»“æœ**ï¼š
- âœ… ä¸¤ä¸ªæ“ä½œå®Œå…¨ç‹¬ç«‹
- âœ… äº’ä¸å¹²æ‰°
- âœ… éƒ½æˆåŠŸè¿”å›ç»“æœ

---

### åœºæ™¯ 2ï¼šToken åˆ·æ–°æ—¶æœºä¸åŒ

```javascript
// æ—¶é—´çº¿ï¼š
T=0:   èˆªç­è·å– Token Aï¼ˆæœ‰æ•ˆæœŸåˆ° T=30minï¼‰
T=1:   é…’åº—è·å– Token Bï¼ˆæœ‰æ•ˆæœŸåˆ° T=31minï¼‰

T=25:  èˆªç­ä½¿ç”¨ Token Aï¼ˆè¿˜æœ‰5åˆ†é’Ÿæœ‰æ•ˆï¼‰
T=26:  é…’åº—ä½¿ç”¨ Token Bï¼ˆè¿˜æœ‰5åˆ†é’Ÿæœ‰æ•ˆï¼‰

T=26:  èˆªç­åˆ·æ–° Token A â†’ Token Cï¼ˆæœ‰æ•ˆæœŸåˆ° T=56minï¼‰
T=31:  é…’åº—åˆ·æ–° Token B â†’ Token Dï¼ˆæœ‰æ•ˆæœŸåˆ° T=61minï¼‰
```

**ç»“æœ**ï¼š
- âœ… Token åˆ·æ–°æ—¶æœºä¸åŒï¼Œä½†äº’ä¸å½±å“
- âœ… å„è‡ªç‹¬ç«‹ç®¡ç†ç”Ÿå‘½å‘¨æœŸ
- âœ… ä¸ä¼šäº’ç›¸å¹²æ‰°

---

### åœºæ™¯ 3ï¼šä¸€ä¸ª Token è¿‡æœŸï¼Œå¦ä¸€ä¸ªæœ‰æ•ˆ

```javascript
// æ—¶é—´çº¿ï¼š
T=0:   èˆªç­è·å– Token Aï¼ˆæœ‰æ•ˆæœŸåˆ° T=30minï¼‰
T=1:   é…’åº—è·å– Token Bï¼ˆæœ‰æ•ˆæœŸåˆ° T=31minï¼‰

T=30:  Token A è¿‡æœŸ
T=30:  èˆªç­è°ƒç”¨ â†’ base.js æ£€æµ‹åˆ°è¿‡æœŸ â†’ è‡ªåŠ¨åˆ·æ–° â†’ Token C
T=30:  é…’åº—è°ƒç”¨ â†’ SDK æ£€æµ‹åˆ° Token B ä»æœ‰æ•ˆ â†’ ä½¿ç”¨ Token B
```

**ç»“æœ**ï¼š
- âœ… Token A è¿‡æœŸä¸å½±å“ Token B
- âœ… èˆªç­è‡ªåŠ¨åˆ·æ–°ï¼Œä¸å½±å“é…’åº—
- âœ… é…’åº—ç»§ç»­ä½¿ç”¨æœ‰æ•ˆ Token

---

## âš ï¸ æ½œåœ¨é—®é¢˜åˆ†æ

### 1. **Token è·å–é¢‘ç‡å¢åŠ **

**é—®é¢˜**ï¼š
- åŒ Token æ„å‘³ç€å¯èƒ½åŒæ—¶æœ‰ä¸¤ä¸ª Token è¯·æ±‚

**å½±å“**ï¼š
- âš ï¸ Token è·å–é¢‘ç‡ï¼šä» 1 æ¬¡/30åˆ†é’Ÿ â†’ 2 æ¬¡/30åˆ†é’Ÿ
- âœ… Amadeus API é™åˆ¶ï¼šé€šå¸¸ 10 requests/secondï¼Œå®Œå…¨è¶³å¤Ÿ
- âœ… å½±å“å¯å¿½ç•¥

**è§£å†³æ–¹æ¡ˆ**ï¼š
- âœ… æ— éœ€è§£å†³ï¼Œå½±å“å¯å¿½ç•¥
- âœ… å¦‚æœæ‹…å¿ƒï¼Œå¯ä»¥ç»Ÿä¸€ Token ç®¡ç†ï¼ˆä½†ä¼šå¢åŠ å¤æ‚åº¦ï¼‰

---

### 2. **å†…å­˜å ç”¨**

**é—®é¢˜**ï¼š
- ä¸¤ä¸ª Token ç¼“å­˜å ç”¨æ›´å¤šå†…å­˜

**å½±å“**ï¼š
- âœ… Token å¤§å°ï¼šçº¦ 100-200 bytes
- âœ… å†…å­˜å ç”¨ï¼šå¯å¿½ç•¥ä¸è®¡
- âœ… å½±å“å¯å¿½ç•¥

**è§£å†³æ–¹æ¡ˆ**ï¼š
- âœ… æ— éœ€è§£å†³ï¼Œå½±å“å¯å¿½ç•¥

---

### 3. **æ—¥å¿—æ··ä¹±**

**é—®é¢˜**ï¼š
- ä¸¤ä¸ª Token è·å–å¯èƒ½äº§ç”Ÿæ··ä¹±çš„æ—¥å¿—

**å½±å“**ï¼š
- âš ï¸ æ—¥å¿—ä¸­å¯èƒ½å‡ºç°ä¸¤ä¸ªä¸åŒçš„ Token
- âš ï¸ è°ƒè¯•æ—¶å¯èƒ½æ··æ·†

**è§£å†³æ–¹æ¡ˆ**ï¼š
```javascript
// åœ¨æ—¥å¿—ä¸­æ ‡è¯† Token æ¥æº
logger.debug('Amadeus Access Tokenè·å–æˆåŠŸ [base.js]', { token: token.substring(0, 10) });
logger.debug('Amadeus Access Tokenè·å–æˆåŠŸ [SDK]', { token: token.substring(0, 10) });
```

---

## âœ… æœ€ä½³å®è·µå»ºè®®

### 1. **ä¿æŒ Token ç¼“å­˜éš”ç¦»**

âœ… **æ¨è**ï¼šä¿æŒä¸¤ä¸ªç‹¬ç«‹çš„ Token ç¼“å­˜
- ç®€å•æ¸…æ™°
- äº’ä¸å¹²æ‰°
- æ˜“äºç»´æŠ¤

âŒ **ä¸æ¨è**ï¼šç»Ÿä¸€ Token ç®¡ç†
- å¢åŠ å¤æ‚åº¦
- éœ€è¦ä¿®æ”¹ç°æœ‰ä»£ç 
- å¯èƒ½å¼•å…¥æ–°é—®é¢˜

---

### 2. **æ·»åŠ æ—¥å¿—æ ‡è¯†**

```javascript
// base.js
logger.debug('Amadeus Access Tokenè·å–æˆåŠŸ [èˆªç­ä¸šåŠ¡]', {
  source: 'base.js',
  expiresIn: expiresIn,
});

// SDK ä½¿ç”¨
logger.debug('Amadeus Access Tokenè·å–æˆåŠŸ [é…’åº—ä¸šåŠ¡]', {
  source: 'SDK',
  expiresIn: expiresIn,
});
```

---

### 3. **ç›‘æ§ Token è·å–é¢‘ç‡**

```javascript
// æ·»åŠ ç›‘æ§æŒ‡æ ‡
const tokenMetrics = {
  baseJsTokenRequests: 0,
  sdkTokenRequests: 0,
};

// åœ¨ getAccessToken ä¸­è®°å½•
tokenMetrics.baseJsTokenRequests++;
```

---

## ğŸ“ æœ€ç»ˆç»“è®º

### âœ… **åŒ Token ä¸ä¼šå½±å“åŸæœ‰ä¸šåŠ¡**

**åŸå› **ï¼š

1. âœ… **Token ç¼“å­˜éš”ç¦»**ï¼šä¸¤ä¸ªç¼“å­˜å®Œå…¨ç‹¬ç«‹ï¼Œäº’ä¸å¹²æ‰°
2. âœ… **API è°ƒç”¨éš”ç¦»**ï¼šèˆªç­å’Œé…’åº—ä½¿ç”¨ä¸åŒçš„ Tokenï¼Œè°ƒç”¨é“¾éš”ç¦»
3. âœ… **ç”Ÿå‘½å‘¨æœŸç‹¬ç«‹**ï¼šä¸¤ä¸ª Token å„è‡ªç®¡ç†ç”Ÿå‘½å‘¨æœŸï¼Œäº’ä¸å½±å“
4. âœ… **é”™è¯¯éš”ç¦»**ï¼šä¸€ä¸ª Token å¤±è´¥ä¸å½±å“å¦ä¸€ä¸ª
5. âœ… **æ€§èƒ½å½±å“å¯å¿½ç•¥**ï¼šToken è·å–é¢‘ç‡å¢åŠ å¾ˆå°ï¼ˆ1æ¬¡/30åˆ†é’Ÿï¼‰

**å”¯ä¸€å½±å“**ï¼š
- âš ï¸ Token è·å–é¢‘ç‡ï¼šä» 1 æ¬¡/30åˆ†é’Ÿ â†’ 2 æ¬¡/30åˆ†é’Ÿï¼ˆå¯å¿½ç•¥ï¼‰
- âš ï¸ å†…å­˜å ç”¨ï¼šå¢åŠ çº¦ 200 bytesï¼ˆå¯å¿½ç•¥ï¼‰
- âš ï¸ æ—¥å¿—å¯èƒ½æ··ä¹±ï¼šéœ€è¦æ·»åŠ æ ‡è¯†ï¼ˆå®¹æ˜“è§£å†³ï¼‰

**å»ºè®®**ï¼š
- âœ… **å¯ä»¥æ”¾å¿ƒä½¿ç”¨åŒ Token æ–¹æ¡ˆ**
- âœ… **æ·»åŠ æ—¥å¿—æ ‡è¯†ä¾¿äºè°ƒè¯•**
- âœ… **ç›‘æ§ Token è·å–é¢‘ç‡ï¼ˆå¯é€‰ï¼‰**

---

## ğŸ¯ æ€»ç»“

**åŒ Token æ–¹æ¡ˆæ˜¯å®‰å…¨çš„**ï¼Œä¸ä¼šå¯¹åŸæœ‰ä¸šåŠ¡äº§ç”Ÿä»»ä½•è´Ÿé¢å½±å“ã€‚ä¸¤ä¸ª Token ç¼“å­˜å®Œå…¨ç‹¬ç«‹ï¼Œäº’ä¸å¹²æ‰°ï¼Œå„è‡ªç®¡ç†è‡ªå·±çš„ç”Ÿå‘½å‘¨æœŸã€‚

**ç±»æ¯”**ï¼š
å°±åƒä¸¤ä¸ªç‹¬ç«‹çš„"é’¥åŒ™ä¸²"ï¼Œå„è‡ªç®¡ç†è‡ªå·±çš„é’¥åŒ™ï¼Œäº’ä¸å¹²æ‰°ã€‚

